library(ggplot2)
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=2)+
scale_colour_viridis_b()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=2,shape=15)+
scale_colour_viridis_b()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_b()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
trim <- total[total$Latitude<65,]
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
trim <- total[total$Latitude<67,]
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_f()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_b()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_a()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_d()
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
devtools::install_github("alexandra-howard/ppgm@new-2024")
library(ppgm)
data("occurrences")
data("sampletrees")
ex_mytree <- sample(sampletrees,5)
data("scel_fossils")
test_ppgm <- ppgm(occurrences = occurrences,trees = ex_mytree, model = "OU", which.biovars = c(1,4,15))
cem_min <- cbind(test_ppgm$cem[, 1], test_ppgm$cem[, 2], test_ppgm$cem[, 3])
cem_max <- cbind(test_ppgm$cem[, 7], test_ppgm$cem[, 8], test_ppgm$cem[, 9])
rownames(cem_min) <- rownames(cem_max) <- rownames(test_ppgm$cem)
??ppgmMESS
mess <- ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,which.biovars=c(1,4,15),which.plot="mess")
mess <- ppgmMESS(cem_min,cem_max,test_ppgm$node_est,fossils=scel_fossils,tree=sampletrees,timeslice=10,which.biovars=c(1,4,15),which.plot="mess")
setwd("C:/Users/alexandra.howard/Documents/upload")
data("occurrences")
mess <- ppgmMESS(cem_min,cem_max,test_ppgm$node_est,fossils=scel_fossils,tree=sampletrees,timeslice=c(5,10),which.biovars=c(1,4,15),which.plot="mess")
test_ppgm <- ppgm(occurrences = occurrences,trees = ex_mytree, model = "estimate", which.biovars = c(1,4,15))
test_ppgm$print_table_min
test_ppgm$print_table_min
print_table_min <- test_ppgm$print_table_min
print_table_max <- test_ppgm$print_table_max
aicmin <- print(cbind(MAT = apply(print_table_min[, seq(1, dim(print_table_min)[2], 3)], 1, min), TS = apply(print_table_min[, seq(2, dim(print_table_min)[2], 3)], 1, min), MTCM = apply(print_table1_min, 1, min), PS = apply(print_table_min[, seq(3, dim(print_table_min)[2], 3)], 1, min)), digits = 5)
aicmin <- print(cbind(bio1 = apply(print_table_min[, seq(1, dim(print_table_min)[2], 3)], 1, min), bio4 = apply(print_table_min[, seq(2, dim(print_table_min)[2], 3)], 1, min), bio15 = apply(print_table_min[, seq(3, dim(print_table_min)[2], 3)], 1, min)), digits = 5)
apply(print_table_min[, seq(1, dim(print_table_min)[2], 3)], 1, min)
apply(print_table_min[, seq(2, dim(print_table_min)[2], 3)], 1, min)
apply(print_table_min[, seq(3, dim(print_table_min)[2], 3)], 1, min)
which.biovars = c(1,4,15)
aicmin <- aicmax <- list()
aicmin <- aicmax <- list()
which.biovars = c(1,4,15)
for(b in 1:length(which.biovars)){
aicmin[[b]] <- apply(print_table_min[, seq(i, dim(print_table_min)[2], 3)], 1, min)
aicmax[[b]] <- apply(print_table_min[, seq(i, dim(print_table_max)[2], 3)], 1, min)
}
for(b in 1:length(which.biovars)){
aicmin[[b]] <- apply(print_table_min[, seq(b, dim(print_table_min)[2], 3)], 1, min)
aicmax[[b]] <- apply(print_table_min[, seq(b, dim(print_table_max)[2], 3)], 1, min)
}
View(aicmin)
print_table_min[, seq(b, dim(print_table_min)[2], 3)]
cbind(aicmin)
names(aicmin) <- names(aicmax) <-which.biovars
View(mess)
View(print_table_max)
View(ex_mytree)
View(print_table_min)
globalLinages <- readRDS("C:/Users/alexandra.howard/OneDrive - Texas A&M AgriLife/Aleja_PPGM/globalLinages.RDS")
PRESENT <- globalLinages[[1]]
SUM <- PRESENT[[1]][5:57]
SUM <- PRESENT[[1]][5:57]+PRESENT[[2]][5:57]+PRESENT[[3]][5:57]+PRESENT[[4]][5:57]
all <- if(SUM,4)
all <- which(SUM==4)
all <- any(SUM==4)
all <- SUM[SUM==4,]
all <- SUM[SUM==4]
all <- SUM[SUM==4,]
SUMpres <- PRESENT[[1]][5:57]+PRESENT[[2]][5:57]+PRESENT[[3]][5:57]+PRESENT[[4]][5:57]
all <- SUMpres[SUMpres==4,]
all <- SUMpres[,SUMpres]
library(dplyr)
all <- SUMpres %>% filter(SUMpres[,]==4)
SUMpres[,]==4
all <-SUMpres[,]==4
all <-as.data.frame(SUMpres[,]==4)
all <-as.data.frame(SUMpres[,]==4)*1
complete<- cbind(PRESENT[1:3],all)
complete<- rbind(PRESENT[1:3],all)
complete<- cbind(PRESENT[[1]][1:3],all)
plot(complete$Longitude,complete$Latitude,col=complete$1)
plot(complete$Longitude,complete$Latitude)
plot(complete$Longitude,complete$Latitude, col=as.factor(complete$1))
plot(complete$Longitude,complete$Latitude, col=as.character(complete$1))
plot(complete$Longitude,complete$Latitude, col=as.character(complete[[4]]))
complete$richness <-sum(complete[3:56])
complete$richness <-colSums(complete[3:56])
complet$richness <- NA
complete$richness <- NA
complete$richness <-colSums(complete[3:56])
View(complete)
complete$richness <-rowSums(complete[3:56])
complete$richness <-rowSums(complete[4:56])
plot(complete$Longitude,complete$Latitude, col=complete$richness)
View(SUM)
present <- globalLinages[[1]]
presentbio1 <- present[[1]]
presentbio1$rich <- rowSums(presentbio1[,c(5:57)])
plot(presentbio1$Longitude,presentbio1$Latitude,col=presentbio1$rich)
plot(presentbio1$bio1,presentbio1$rich)
plot(presentbio1[[20]],presentbio1$rich)
all <- present[[1]][,5:57]+present[[2]][,5:57]+present[[3]][,5:57]+present[[4]][,5:57]
complete <- as.data.frame(all[,]==4)
complete <- complete*1
total <- cbind(presentbio1[,1:3],complete)
total$rich <- rowSums(total[,4:56])
plot(total$Longitude,total$Latitude,col=total$rich)
plot(total$Latitude, total$rich)
total$rich[total$rich==0] <- NA
trim <- total[total$Latitude<67,]
library(ggplot2)
ggplot(data=trim,aes(x=Longitude,y=Latitude,colour=rich)) +
geom_point(size=1.5,shape=15)+
scale_colour_viridis_c()
names(trim[,4:57]) <- unique(occurrences$Species)
View(trim)
unique(occurrences$Species)
sp <- unique(occurrences$Species)
colnames(trim[,4:57]) <- sp
View(trim)
colnames(trim[4:57]) <- sp
names(trim[4:57]) <- sp
sp
sp <- as.vector(sp)
names(trim[4:57]) <- sp
colnames(trim[4:57]) <- sp
names(trim[4:57])
names(trim[4:56]) <- sp
sp
length(names(trim[4:56])) <- sp
length(names(trim[4:56]))
colnames(trim[4:56]) <- sp
View(trim)
trim
colnames(trim[4:56]) <- sp
colnames(complete) <-sp
total <- cbind(presentbio1[,1:3],complete)
total$rich <- rowSums(total[,4:56])
trim <- total[total$Latitude<67,]
bodysize <- read.csv("bodysize.csv")
allbodysize <- read.csv("bodysize.csv")
bodysize <- allbodysize[allbodysize$sp==sp,]
bodysize <- allbodysize[allbodysize$sp %in% sp,]
allbodysize <- read.csv("bodysize_small.csv")
allbodysize <- read.csv("bodysize_small.csv")
allbodysize <- read.csv("bodysize_small.csv")
bodysize <- allbodysize[allbodysize$sp %in% sp,]
match(names(trim),bodysize$)
match(names(trim),bodysize$sp)
length(match(names(trim),bodysize$sp))
matchedsize <- bodysize[-1:3,]
matchedsize <- bodysize[-1,]
bodysize <- allbodysize[allbodysize$sp %in% sp,]
match(names(trim),bodysize$sp)
new <- trim
match(names(trim[4:56]),bodysize$sp)
new[21]
names(new[21])
match(names(trim[4:56]),bodysize$sp)
View(bodysize)
View(trim)
names(new[36])
names2 <- bodysize$sp
names1 <- names(trim[4:56])
match(names1,names2)
names1[21]
names2[21]
names(trim[24])
new <- trim[-24,]
new <- trim
new <- trim[-24]
names2[34]
names1[34]
new <- new[-"palaciosi"]
names(new[34])
names(new[35])
names(new[33])
names(new[36])
new <- new[-36]
i<-1
size <- bodysize$sp[i]
size <- bodysize$maxFSVL[i]
data <- new[i+3]
data[data==1]
data[data==1] <-size
View(data)
summary(data)
sizes <- list()
for(i in 1:length(bodysize$sp)){
size <- bodysize$maxFSVL[i]
data <- new[i+3]
data[data==1] <-size
sizes[i] <- data
}
sizes <- as.data.frame(sizes)
View(sizes)
names(sizes) <- names(new)
names(sizes) <- bodysize$sp
var <- sapply(sizes,var)
View(sizes)
var
?apply
var <- apply(sizes,var)
var <- apply(sizes,FUN=var)
var <- apply(sizes,1,FUN=var)
new$var <- var
plot(new$var,new$rich)
plot(new$rich,new$var)
sd <- apply(sizes,1,FUN=sd)
new$sd <- sd
plot(new$rich,new$sd)
max <- apply(sizes,1,FUN=max)
new$max <- max
plot(new$rich,new$max)
min <- apply(sizes,1,FUN=min)
new$min <- min
plot(new$rich,new$min)
plot(new$rich,new$sd)
mean <- apply(sizes,1,FUN=mean)
new$mean <-mean
plot(new$rich,new$mean)
View(new)
range(sizes)
summary(new)
summary(sizes)
var(sizes[,1])
var(sizes[,50])
var(sizes[,8000])
var(sizes[,])
sizes[1]
sizes[,1]
var(sizes[,1])
length(sizes)
rowlength(sizes)
length(sizes[,1])
var <- list()
var <- c()
for (i in 1:length(sizes[,1])){
var[i] <- var(sizes[,i])
}
sizes[,1]
var(sizes[,1])
var(sizes[,2])
for (i in 1:length(sizes[,1])){
var[i] <- var(sizes[,i])
}
for (i in 1:length(sizes[,1])){
data <- sizes[,i]
var[i] <- var(data)
}
data <- sizes[,i]
i<-1
data <- sizes[,i]
var[i] <- var(data)
data <- sizes[,i]
var <- var(data)
for (i in 1:length(sizes[,1])){
data <- sizes[,i]
var <- var(data)
}
for (i in 1:length(sizes[,1])){
data <- sizes[,i]
var <- var(data)
out[i] <-var
}
out <- list()
for (i in 1:length(sizes[,1])){
data <- sizes[,i]
var <- var(data)
out[i] <-var
}
var <- c()
for (i in 1:length(sizes[,1])){
data <- sizes[,i]
var[[i]] <- var(data)
}
length(sizes[,1])
var[[i]]
var[i]
mutate(sizes,variance= var(sizes))
var <- apply(sizes,1,FUN=var)
summary(var)
summary(sizes)
class(sizes)
class(sizes[1])
class(sizes[[1]])
new$taeniocnemis <-NA
new$taeniocnemis <-NULL
new$ornatus <-NULL
new$cautus <-NULL
summary(new)
new <- new[1:51]
summary(bodysize)
names(new)
body2 <- bodysize[bodysize$sp %in% names(new),]
length(body2)
length(body2$sp)
length(new[])
length(new[])-3
trimmed <- new[4:51]
match(names(trimmed),body2$sp)
trimmed[32]
names(trimmed[32])
View(body2)
trimmed <- trimmed[-32]
sizes <- list()
sizes <- list()
for(i in 1:length(body2$sp)){
size <- bodysize$maxFSVL[i]
data <- trimmed[i+3]
data[data==1] <-size
sizes[i] <- data
}
for(i in 1:length(body2$sp)){
size <- bodysize$maxFSVL[i]
data <- trimmed[i]
data[data==1] <-size
sizes[i] <- data
}
summary(trimmed)
sizes <- as.data.frame(sizes)
names(sizes) <- bodysize$sp
names(sizes) <- body2$sp
View(sizes)
var <- apply(sizes,1,FUN=var)
trimmed$rich <- rowSums(trimmed)
plot(trimmed$rich,vara)
plot(trimmed$rich,var)
mean <- apply(sizes,1,FUN=mean)
plot(trimmed$rich,mean)
?apply
sizes2<-sizes
sizes2[sizes2==0] <- NA
var <- apply(sizes2,1,FUN=var)
mean <- apply(sizes2,1,FUN=mean,)
plot(trimmed$rich,mean)
mean <- apply(sizes2,1,FUN=mean)
plot(trimmed$rich,mean)
symmary(mean)
summary(mean)
var <- apply(sizes2,1,FUN=var, na.rm=TRUE)
mean <- apply(sizes2,1,FUN=mean, na.rm=TRUE)
plot(trimmed$rich,var)
plot(trimmed$rich,mean)
plot(trimmed$rich,var)
plot(trimmed$rich,mean)
sd <- apply(sizes2,1,FUN=sd,na.rm=TRUE)
plot(trimmed$rich,sd)
save(trimmed,file="trimmed.rda")
save(sizes2, file="sizes2.rda")
View(sizes2)
View(trimmed)
View(paleoclimate)
View(paleoclimate[[1]])
newpclim <- list()
for (i in 1: length(paleoclimate)){
new <- paleoclimate[[i]]
new <- new[new$Latitude<32.5149,]
newpclim[[i]] <- new
}
plot(new[[1]]$Latitude,new[[1]]$Longitude)
plot(newpclim[[1]]$Latitude,newpclim[[1]]$Longitude)
plot(newpclim[[1]]$Longitude,newpclim[[1]]$Latitude)
for (i in 1: length(paleoclimate)){
new <- paleoclimate[[i]]
new <- new[new$Latitude<32.5149,]
new <-  new[new$Longitude<-108,]
newpclim[[i]] <- new
}
plot(newpclim[[1]]$Longitude,newpclim[[1]]$Latitude)
newpclim <- list()
for (i in 1: length(paleoclimate)){
new <- paleoclimate[[i]]
new <- new[new$Latitude<32.5149,]
new <-  new[new$Longitude<(-108),]
newpclim[[i]] <- new
}
plot(newpclim[[1]]$Longitude,newpclim[[1]]$Latitude)
newocc <- occurrences[occurrences$Latitude<32.5149,]
newocc <- newocc[newocc$Longitude<(-108),]
plot(newocc$Longitude, newocc$Latitude)
unique(newocc$Species)
View(newocc)
summary(newocc)
ex_mytree
plot(ex_mytree[[1]])
newocc <- subset(newocc, newocc$Species=c("clarkii","orcutti","zosteromus"))
newocc <- subset(newocc, newocc$Species==c("clarkii","orcutti","zosteromus"))
summary(newocc)
newocc2 <-as.data.frame(newocc)
newocc2$Species <- as.factor(newocc$Species)
newocc2 <- droplevels(newocc)
data("scel_fossils")
View(scel_fossils)
newfos <- scel_fossils$Latitude<32.5149
scelfos <- as.data.frame(scel_fossils)
scelfos <- scelfos[scelfos$Latitude<32.5149,]
scelfos <- scelfos[scelfos$Longitude<(-108),]
View(scelfos)
plot(newocc$Longitude, newocc$Latitude)
points(scelfos$Longitude,scelfos$Latitude)
points(scelfos$Longitude,scelfos$Latitude, col="red")
class(scel_fossils)
testfos <- as.matrix(scelfos)
View(testfos)
testocc <- newocc2
testclim <- newpclim
data(sampletrees)
install.packages("phylobase")
library(phylobase)
subset(sampletrees, tips.include=c("clarkii","orcutti","zosteromus"))
newtrees <- phylobase::subset(sampletrees, tips.include=c("clarkii","orcutti","zosteromus"))
newtrees <- prune(sampletrees, tips.include=c("clarkii","orcutti","zosteromus"))
for (i in 1:length(sampletrees)){newtrees[[i]] <- prune(sampletrees[[i]], tips.include=c("clarkii","orcutti","zosteromus"))
}
library(ape)
data(sampletrees)
tips <- c("clarkii","orcutti","zosteromus")
tree <- drop.tip(sampletrees[[1]],setdiff(sampletrees[[1]]$tip.label,tips))
View(tree)
View(tree)
plot(tree)
newtree <- list()
newtree <- list()
for (i in 1:length(sampletrees)){
newtree[[i]] <- drop.tip(sampletrees[[1]],setdiff(sampletrees[[i]]$tip.label,tips))
}
testtree <- newtree
setwd("C:/Users/alexandra.howard/Documents/GitHub/tests/testthat/testdata")
save(testfos, file="testfos.rda")
save(testocc, file="testocc.rda")
save(testocc, file="testclim.rda")
save(testclim, file="testclim.rda")
save(testtree, file="testtree.rda")
setwd("C:/Users/alexandra.howard/Documents/upload")
data(sampletrees)
data(occurrences)
bounds <- list(sigsq = c(min = 0, max = 1000000))
test_ppgm <- ppgm(occurrences = occurrences,trees = sampletrees,
model = "BM", which.biovars = c(1), bounds = bounds,
control = list(niter = 20))
library(devtools)
devtools::load_all()
warnings()
test_ppgm <- ppgm(occurrences = occurrences,trees = sampletrees,
model = "BM", which.biovars = c(1), bounds = bounds,
control = list(niter = 20))
cem_min <- cbind(test_ppgm$cem[, 1], test_ppgm$cem[, 2], test_ppgm$cem[, 3])
cem_max <- cbind(test_ppgm$cem[, 7], test_ppgm$cem[, 8], test_ppgm$cem[, 9])
cem_min <- cbind(test_ppgm$cem[, 1])
cem_max <- cbind(test_ppgm$cem[, 3])
rownames(cem_min) <- rownames(cem_max) <- rownames(test_ppgm$cem)
ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1),which.plot="all")
sampletrees <- sample(sampletrees,5)
test_ppgm <- ppgm(occurrences = occurrences,trees = sampletrees,
model = "BM", which.biovars = c(1,4,15), bounds = bounds,
control = list(niter = 20))
cem_min <- cbind(test_ppgm$cem[, 1], test_ppgm$cem[, 2], test_ppgm$cem[, 3])
cem_max <- cbind(test_ppgm$cem[, 7], test_ppgm$cem[, 8], test_ppgm$cem[, 9])
rownames(cem_min) <- rownames(cem_max) <- rownames(test_ppgm$cem)
ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15),which.plot="all")
fossils <- FALSE
fossils[, 1]
devtools::load_all()
devtools::load_all()
ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15),which.plot="all")
pdata <- sp::spTransform(spdata, CRS("+init=epsg:26978"))
fossils!=FALSE
devtools::load_all()
ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15),which.plot="all")
devtools::load_all()
ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15),which.plot="all")
mess <- ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15),which.plot="all")
class(mess[[1]])
class(mess)
devtools::check()
devtools::check()
devtools::document()
devtools::document()
